{% extends 'layout.html' %}

{% block title %}Join the War - Corinth's Plight{% endblock %}

{% block content %}
<div class="auth-page">
    <div class="auth-background">
        <div class="auth-particles">
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
        </div>
    </div>
    
    <div class="container">
        <div class="auth-container">
            <div class="auth-header">
                <div class="auth-icon"><i class="fas fa-sword"></i></div>
                <h1 class="auth-title">Join the War</h1>
                <p class="auth-subtitle">Enter the strategic warfare universe and command your forces</p>
            </div>
            
            <div class="auth-tabs">
                <button class="tab-btn active" data-tab="login">Login</button>
                <button class="tab-btn" data-tab="signup">Sign Up</button>
            </div>
            
            <!-- Login Form -->
            <div class="auth-form-container active" id="login-form">
                <form action="{{ url_for('handle_login') }}" method="post" class="auth-form">
                    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
                    
                    <div class="form-group">
                        <label for="login-username" class="form-label">Username</label>
                        <input type="text" id="login-username" name="username" class="form-input" placeholder="Enter your username" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="login-password" class="form-label">Password</label>
                        <input type="password" id="login-password" name="password" class="form-input" placeholder="Enter your password" required>
                    </div>
                    
                    <button type="submit" class="btn btn-primary btn-full">
                        <span class="btn-icon"><i class="fas fa-rocket"></i></span>
                        <span class="btn-text">Enter the War</span>
                    </button>
                </form>
            </div>
            
            <!-- Signup Form -->
            <div class="auth-form-container" id="signup-form">
                <form action="{{ url_for('signup_user') }}" method="post" class="auth-form">
                    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
                    
                    <div class="form-group">
                        <label for="signup-username" class="form-label">Username</label>
                        <input type="text" id="signup-username" name="setusername" class="form-input" placeholder="Choose a username" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="signup-email" class="form-label">Email</label>
                        <input type="email" id="signup-email" name="setemail" class="form-input" placeholder="Enter your email" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="signup-password" class="form-label">Password</label>
                        <input type="password" id="signup-password" name="createpassword" class="form-input" placeholder="Create a password" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="signup-confirm" class="form-label">Confirm Password</label>
                        <input type="password" id="signup-confirm" name="confirmpassword" class="form-input" placeholder="Confirm your password" required>
                    </div>
                    
                    <button type="submit" class="btn btn-primary btn-full">
                        <span class="btn-icon"><i class="fas fa-sword"></i></span>
                        <span class="btn-text">Join the Campaign</span>
                    </button>
                </form>
            </div>
            
            <div class="auth-footer">
                <p class="auth-footer-text">By joining, you agree to our terms of service and privacy policy</p>
            </div>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const tabBtns = document.querySelectorAll('.tab-btn');
    const formContainers = document.querySelectorAll('.auth-form-container');
    
    tabBtns.forEach(btn => {
        btn.addEventListener('click', function() {
            const targetTab = this.dataset.tab;
            
            // Remove active class from all tabs and forms
            tabBtns.forEach(b => b.classList.remove('active'));
            formContainers.forEach(f => f.classList.remove('active'));
            
            // Add active class to clicked tab and corresponding form
            this.classList.add('active');
            document.getElementById(targetTab + '-form').classList.add('active');
        });
    });
    
    // Add form validation
    const forms = document.querySelectorAll('.auth-form');
    forms.forEach(form => {
        form.addEventListener('submit', function(e) {
            const submitBtn = this.querySelector('button[type="submit"]');
            const originalText = submitBtn.innerHTML;
            
            submitBtn.innerHTML = '<span class="loading"></span> Processing...';
            submitBtn.disabled = true;
            
            // Re-enable after 5 seconds as fallback
            setTimeout(() => {
                if (submitBtn.disabled) {
                    submitBtn.innerHTML = originalText;
                    submitBtn.disabled = false;
                }
            }, 5000);
        });
    });
});
</script>
{% endblock %}
